#!/usr/bin/env node
import N from 'chalk';
import { Command } from 'commander';
import yt from 'gradient-string';
import { exec, execSync } from 'node:child_process';
import Un, { existsSync, mkdirSync, writeFileSync, readFileSync, renameSync } from 'node:fs';
import Qn from 'async-retry';
import Zn, { oraPromise } from 'ora';
import Vn from 'fast-glob';
import { fileURLToPath } from 'node:url';
import yo, { resolve, join, basename } from 'pathe';
import { findUp } from 'find-up';
import lt from '@winches/prompts';
import * as _ from '@clack/prompts';
import { spinner, text, select, cancel, isCancel } from '@clack/prompts';
import { Readable } from 'node:stream';
import { pipeline } from 'node:stream/promises';
import $o from 'tar';

var wt=["#F54180","#338EF7"],Ge=yt(...wt),On=Ge("NextUI CLI:"),s=class{constructor(){}static log(...t){console.log(...t);}static info(...t){console.info(...t.map(n=>N.blue(n)));}static success(...t){console.info(...t.map(n=>N.green(n)));}static warn(...t){console.warn(...t.map(n=>N.yellow(n)));}static error(...t){console.error(...t.map(n=>N.red(n)));}static grey(...t){console.log(...t.map(n=>N.gray(n)));}static gradient(t,n){this.log(yt(...n?.colors??wt)(String(t)));}static prefix(t,...n){return this[t](On,...n)}static newLine(t){t||(t=1);for(let n=0;n<t;n++)this.log();}};function _n(e,t){let n=0,o=e.length,r=t.length,i=0,a=0;for(;i<o&&a<r;)e[i]===t[a]&&(n++,a++),i++;return n}function ke(e,t){let n=0,o="";for(let r of e){let i=_n(r,t);i>n&&(n=i,o=r);}return o!==""?o:null}function He(e,t){let n=ke(e,t);n?s.error(`Unknown option '${t}', Did you mean '${n}'?`):s.error(`Unknown option '${t}'`),process.exit(1);}var We={bold:{bottomLeft:"\u2517",bottomRight:"\u251B",horizontal:"\u2501",topLeft:"\u250F",topRight:"\u2513",vertical:"\u2503"},classic:{bottomLeft:"+",bottomRight:"+",horizontal:"-",topLeft:"+",topRight:"+",vertical:"|"},double:{bottomLeft:"\u255A",bottomRight:"\u255D",horizontal:"\u2550",topLeft:"\u2554",topRight:"\u2557",vertical:"\u2551"},doubleSingle:{bottomLeft:"\u2558",bottomRight:"\u255B",horizontal:"\u2550",topLeft:"\u2552",topRight:"\u2555",vertical:"\u2502"},round:{bottomLeft:"\u2570",bottomRight:"\u256F",horizontal:"\u2500",topLeft:"\u256D",topRight:"\u256E",vertical:"\u2502"},single:{bottomLeft:"\u2514",bottomRight:"\u2518",horizontal:"\u2500",topLeft:"\u250C",topRight:"\u2510",vertical:"\u2502"},singleDouble:{bottomLeft:"\u2559",bottomRight:"\u255C",horizontal:"\u2500",topLeft:"\u2553",topRight:"\u2556",vertical:"\u2551"}};var R=process.cwd(),P=e=>resolve(R,e),Ae=resolve(fileURLToPath(import.meta.url),"../components.json");var De=/([\^~])/;function At(e,t){return s.gradient(e),t}function Pt(e){return e.split("-").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join("")}var B=(e,t)=>Vn.sync(`${e}`,{absolute:!0,cwd:R,deep:5,ignore:["node_modules/**","dist/**","build/**","coverage/**","public/**","out/**"],onlyFiles:!0,...t});function Me(e){return e==="false"?!1:!!e}function vt(e,t){return Object.fromEntries(Object.entries(e).filter(([n])=>!t.includes(n)))}function Z(e,t){return e=M(e),t=M(t),Le(e,t)?Le(e,t):Re(e,t)?Re(e,t):kt(e,t)?kt(e,t):t}function Le(e,t){let n=e.split("."),o=t.split(".");return n[0]!==o[0]?N.redBright(o.join(".")):""}function Re(e,t){let n=e.split("."),o=t.split(".");return n[1]!==o[1]?`${N.white(o[0])}${N.white(".")}${N.cyanBright(o.slice(1,3).join("."))}`:""}function kt(e,t){let n=e.split("."),o=t.split(".");return n[2]!==o[2]?`${N.white(o.slice(0,2).join("."))}${N.white(".")}${N.greenBright(o[2])}`:""}function ee(e,t){let n=e[t].replace(De,""),o=e[t].match(De)?.[1]||"";return {currentVersion:n,versionMode:o}}function se(e){return {bun:{install:"add",remove:"remove",run:"run"},npm:{install:"install",remove:"uninstall",run:"run"},pnpm:{install:"add",remove:"remove",run:"run"},yarn:{install:"add",remove:"remove",run:"run"}}[e]}function M(e){return e.replace(/\^|~|>=|<=|>|</g,"")}function J(e,t){let n=e.replace(U,""),o=t-n.length>0?" ".repeat(t-n.length):"";return `${e}${o}`}function j(e){return e.replace(U,"")}var St=resolve(fileURLToPath(import.meta.url),"../.."),Xe=e=>resolve(St,e),bt=resolve(fileURLToPath(import.meta.url),".."),qn=existsSync(join(bt,"components.json")),Oe=qn?resolve(`${bt}/.nextui-cli-cache`):resolve(join(St,".."),"node_modules/.nextui-cli-cache"),_e=resolve(`${Oe}/data.json`);var Bn=30*6e4,Qe=!1;function Ze(e=Qe){Qe=!!e,!existsSync(Oe)&&(mkdirSync(Oe,{recursive:!0}),writeFileSync(_e,JSON.stringify({}),"utf8"));}function je(){let e=readFileSync(_e,"utf8");return JSON.parse(e)}function Nt(e,t,n){Ze();let o=n??je(),r=new Date,i=+r+Bn;o[e]={...t,date:r,expiredDate:i,expiredFormatDate:new Date(i).toString(),formatDate:r.toString()},writeFileSync(_e,JSON.stringify(o,void 0,2),"utf-8");}function Jn(){return +new Date}function Gn(e){return Jn()-e}function Ut(e,t){if(Qe)return !0;let o=(t??je())[e];return o?.expiredDate?Gn(o.expiredDate)>0:!0}async function Et(e){let t=je();if(Ut(e,t)){let o=await et(`npm view ${e} version`,`Fetching ${e} latest version`);Nt(e,{version:o},t);}return t[e]}async function te(e){let t=je();if(Ut(e,t)){let o=await et(e);Nt(e,{execResult:o},t);}return t[e].execResult}function E(e,t){e=M(e),t=M(t);let n=e.split(".").map(Number),o=t.split(".").map(Number);for(let r=0;r<n.length;r++)if(n[r]!==void 0&&o[r]!==void 0){if(n[r]>o[r])return 1;if(n[r]<o[r])return -1}return 0}async function to(){if(!existsSync(Ae)){await Dt();return}let t=JSON.parse(readFileSync(Ae,"utf-8")).version,n=await pe("latestVersion");if(E(t,n)===-1){await Dt(n);return}}async function Rt(){let e={};await to();try{e=JSON.parse(readFileSync(Ae,"utf-8"));}catch(t){}return e}async function et(e,t){t=t??`Executing ${e}`;let n=Zn({discardStdin:!1,spinner:{frames:[`\u280B ${N.gray(`${t}.`)}`,`\u2819 ${N.gray(`${t}..`)}`,`\u2839 ${N.gray(`${t}...`)}`,`\u2838 ${N.gray(`${t}.`)}`,`\u283C ${N.gray(`${t}..`)}`,`\u2834 ${N.gray(`${t}...`)}`,`\u2826 ${N.gray(`${t}.`)}`,`\u2827 ${N.gray(`${t}..`)}`,`\u2807 ${N.gray(`${t}...`)}`,`\u280F ${N.gray(`${t}.`)}`],interval:150}});n.start();let o=await new Promise(r=>{exec(e,(i,a)=>{i&&(s.error(`Exec cmd ${e} error`),process.exit(1)),r(a.trim());});});return n.stop(),o}async function q(e){return (await Et(e)).version}var no=e=>`https://unpkg.com/@nextui-org/react@${e}/dist/components.json`;async function Dt(e){e=e||await pe("latestVersion");let t=no(e),o={components:await oo(t),version:e};writeFileSync(Ae,JSON.stringify(o,null,2),"utf-8");}async function oo(e){let t;return await oraPromise(Qn(async n=>{try{let o=await fetch(e,{body:null,headers:{"Content-Type":"application/json",accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7"},method:"GET",mode:"cors"});t=JSON.parse(await o.text());}catch(o){n(o);}},{retries:3}),{failText(n){s.prefix("error",`Update components data error: ${n}`),process.exit(1);},successText:(()=>N.greenBright(`Components data updated successfully!
`))(),text:"Fetching components data..."}),t}process.env.CI==="true";function S(e,t=!0){let n;try{n=JSON.parse(readFileSync(e,"utf-8"));}catch(l){s.prefix("error",`Error reading package.json file: ${e} 
Error: ${l}`);}let o=n.devDependencies||{},r=n.dependencies||{},i={...o,...r},a=new Set(Object.keys(i)),p=w.nextUIComponents.map(l=>{let m=l.version,y=l.versionMode;if(a.has(l.package)){let h=ee(i,l.package);m=t?`${h.currentVersion} new: ${m}`:h.currentVersion,y=h.versionMode;}return {...l,version:m,versionMode:y}}).filter(l=>a.has(l.package)),g=a.has(k);return {allDependencies:i,allDependenciesKeys:a,currentComponents:p,dependencies:r,devDependencies:o,isAllComponents:g,package:n}}function Mt(e){return e.map(t=>{let o=w.nextUIComponentsMap[t]?.package;return o||t})}async function Ot(e,t,n=!0){let o=[];for(let r of e){let{currentVersion:i}=ee(t,r),{versionMode:a}=ee(t,r),p=(await te(`npm show ${r} homepage`)||"").replace(/\n/,""),g=(await te(`npm show ${r} description`)||"").replace(/\n/,""),l=w.nextUIComponentsPackageMap[r]?.version||await q(r);i=n?`${i} new: ${l}`:i;let m={description:g||"",docs:p||"",name:r,package:r,peerDependencies:{},status:"stable",style:"",version:i,versionMode:a};o.push(m);}return o}var _t="nextui-cli",Pe="framer-motion",ve="tailwindcss",k="@nextui-org/react",G="@nextui-org/theme",ce="@nextui-org/system";var tt="https://nextui.org/docs/guide/installation#global-installation",Ve="https://nextui.org/docs/guide/installation#tailwind-css-setup";var jt="https://nextui.org/docs/guide/installation#setup-pnpm-optional",Fe="https://nextui.org/docs/guide/installation#provider-setup",I={checkPluginsRegex:/nextui(([\W\w]+)?)/,content:"./node_modules/@nextui-org/theme/dist/**/*.{js,ts,jsx,tsx}",darkMode:'darkMode: "class"',importContent:(e=!1)=>e?"import {nextui} from '@nextui-org/theme';":"const {nextui} = require('@nextui-org/theme');",plugins:"nextui()"},qe={content:(e,t)=>{e.forEach(r=>{let i=Vt(r,t);e.push(...i);});let n=[...new Set(e.map(r=>r.style||r.name))];return n.length===1?`./node_modules/@nextui-org/theme/dist/components/${e[0]}.js`:`./node_modules/@nextui-org/theme/dist/components/(${n.reduce((r,i)=>r+=`${i}|`,"").replace(/\|$/,"")}).js`},plugins:"nextui()"},nt={import:"NextUIProvider"},D={content:"public-hoist-pattern[]=*@nextui-org/*"};function Vt(e,t){let n=e.name,o=P(`node_modules/@nextui-org/${n}`),r=[e];if(!existsSync(o)&&t){let a=P("node_modules/.pnpm"),p=Vn.sync(`**/@nextui-org/${n}`,{absolute:!0,cwd:a,onlyDirectories:!0})[0];if(p)o=p;else return r}let{currentComponents:i}=S(join(o,"package.json"));if(i.length)for(let a of i){let p=Vt(a,t);r.push(...p);}return r}var w={};async function pe(e){let t=w[e];return t||(e==="latestVersion"?(t=await q(k),w[e]=t):e==="cliLatestVersion"&&(t=await q(_t),w[e]=t)),t}function le(e){return w[e]}function po(e){let t=e.map(a=>a.name),n=e.map(a=>a.package),o=new Set(t),r=e.reduce((a,p)=>(a[p.name]=p,a),{}),i=e.reduce((a,p)=>(a[p.package]=p,a),{});return {nextUIComponentsKeys:t,nextUIComponentsKeysSet:o,nextUIComponentsMap:r,nextUIComponentsPackageMap:i,nextUIcomponentsPackages:n}}function Ft(e){let{nextUIComponentsKeys:t,nextUIComponentsKeysSet:n,nextUIComponentsMap:o,nextUIComponentsPackageMap:r,nextUIcomponentsPackages:i}=po(e);w.nextUIComponents=e,w.nextUIComponentsKeys=t,w.nextUIComponentsKeysSet=n,w.nextUIComponentsMap=o,w.nextUIComponentsPackageMap=r,w.nextUIcomponentsPackages=i;}var Ye=["package","version","status","docs"],qt=["package","version","status"];var U=/\u001b\[[\d;]+m/g,b=We.round,ot="   ",Ie=`${b.vertical}${ot}`,Yt=`${ot}${b.vertical}${ot}`;function ne({commandName:e,components:t,message:n=`Current installed components:
`,warnError:o=!0}){if(!t.length){o&&s.prefix("warn","No components found");return}let r={description:0,docs:0,name:0,originVersion:0,package:0,peerDependencies:0,status:0,style:0,version:0};for(let m of t)for(let y in m){let h=String(m[y]);if(y==="version"){let c=h.match(/new:\s([\d.]+)/)?.[1],u=h.match(/([\d.]+)\snew:/)?.[1],d=j(Kt(u,c));r[y]=Math.max(r[y],Math.max(d.length,7)),r.originVersion=Math.max(r.originVersion,u.length);continue}r[y]=Math.max(r[y],h.length);}let i=t.reduce((m,y)=>{let h=Ie;for(let c of Ye){let u=J(y[c],r[c]);if(e!=="list"&&c==="version"){let d=u.match(/([\d.]+)\snew:/)?.[1],f=u.match(/new:\s([\d.]+)/)?.[1];d===f?(u=u.replace(/\snew:\s[\d.]+(\s+)?/,""),u=J(`${J(u,r.originVersion)} \u{1F680}latest`,r[c]),u=u.replace("latest",N.magentaBright.underline("latest"))):f&&(u=J(Kt(J(d,r.originVersion),f),r[c]));}y.status==="stable"&&qt.includes(c)?u=N.greenBright(u):y.status==="new"?u=N.magentaBright(u):y.status==="updated"&&(u=N.blueBright(u)),h+=u+Yt;}return m.push(h),m},[]),a=b.topLeft+Ie.replace(/.*/g,b.horizontal).slice(1),p=Ie,g=b.vertical+Ie.replace(/.*/g,b.horizontal).slice(1);for(let m of Ye)a+=`${b.horizontal.padEnd(r[m]+7,b.horizontal)}`,p+=N.redBright(Pt(m).padEnd(r[m]))+Yt,g+=`${b.horizontal.padEnd(r[m]+7,b.horizontal)}`;a=a.slice(0,-2)+b.topRight,g=g.slice(0,-2)+b.vertical;let l=b.bottomLeft+Ie.replace(/.*/g,b.horizontal).slice(1);for(let m of Ye)l+=`${b.horizontal.padEnd(r[m]+7,b.horizontal)}`;l=l.slice(0,-2)+b.bottomRight,i=[a,p,g,...i,l],s.info(n),s.log(i.join(`
`));}function zt(){s.newLine(),s.log(N.redBright("Environment Info:")),s.log(N.blueBright("  System:")),s.log(N.blueBright("    OS:"),process.platform),s.log(N.blueBright("    CPU:"),process.arch),s.log(N.greenBright("  Binaries:")),s.log(N.greenBright("    Node:"),process.version),s.newLine();}function $e({align:e="center",borderStyle:t="round",center:n=!1,color:o,log:r=!0,padding:i=0,text:a,title:p}){let g=We[t],l=o?Object.fromEntries(Object.entries(g).map(([$,T])=>[$,N[o](T)])):g,m=a.split(`
`),y=m.map($=>$.replace(U,"")),h=i>0,c=i,u=n||h,d=y.reduce(($,T)=>T.length>$?T.length:$,0);d=h?d+c*4:d;let f=p?p.replace(U,""):"",C=p?f.length:0,x=d-C,A=2;for(;C+A+c>=d;)d+=Math.floor(C/2);x=d-C;let v=(()=>{if(p)if(e==="center"){let $=Math.floor(x/2)-1,T=Math.ceil(x/2)-1,Je=$>0?l.horizontal.repeat($):"",z=T>0?l.horizontal.repeat(T):"";return `${Je} ${p} ${z}`}else return e==="left"?` ${p} ${l.horizontal.repeat(x-2)}`:`${l.horizontal.repeat(x-2)} ${p} `;return l.horizontal.repeat(d)})(),X=l.topLeft+v+l.topRight,we=l.bottomLeft+l.horizontal.repeat(d)+l.bottomRight,K=m.reduce(($,T)=>{let Je=T.replace(U,""),z=d-Je.length,Dn=" ".repeat(z),ht=Math.floor(z/2),xt=Math.ceil(z/2),Ln=ht>0?" ".repeat(ht):"",Rn=xt>0?" ".repeat(xt):"";if(n)$.push(`${l.vertical}${z?`${Ln}${T}${Rn}`:T}${l.vertical}`);else if(i){let Mn=z-c*2;$.push(`${l.vertical}${" ".repeat(c*2)}${T}${" ".repeat(Mn)}${l.vertical}`);}else $.push(`${l.vertical}${z>0?`${T}${Dn}`:T}${l.vertical}`);return $},[]);if(u)for(let $=0;$<c;$++)K.unshift(`${l.vertical}${" ".repeat(d)}${l.vertical}`),K.push(`${l.vertical}${" ".repeat(d)}${l.vertical}`);return K=[X,...K,we],r&&s.log(K.join(`
`)),K.join(`
`)}function Kt(e,t){return `${N.white(`${e} ->`)} ${N.yellowBright(`${t} (new)`)}`}var Ke={name:"nextui-cli",private:!1,type:"module",license:"MIT",version:"0.3.4",homepage:"https://github.com/nextui-org/nextui-cli#readme",description:"A CLI tool that unlocks seamless NextUI integration",keywords:["UI","CLI","Tool","NextUI","Template","Integration","Add Component"],author:{name:"NextUI",email:"support@nextui.org",url:"https://github.com/nextui-org"},repository:{type:"git",url:"https://github.com/nextui-org/nextui-cli.git"},bugs:{url:"https://github.com/nextui-org/nextui-cli/issues"},publishConfig:{access:"public",registry:"https://registry.npmjs.org/"},files:["dist"],bin:{nextui:"./dist/index.js"},main:"./dist/index.js",module:"./dist/index.js",types:"./dist/index.d.ts",scripts:{dev:"tsup --watch","link:cli":"pnpm link --global","link:remove":"pnpm uninstall --global nextui-cli",build:"tsup","update:components":"tsx src/scripts/update/update-components.ts","sync:docs":"tsx src/scripts/sync/sync.ts","clean:cache":"tsx src/scripts/cache/clean.ts",lint:"eslint . --max-warnings=0","lint:fix":"eslint . --max-warnings=0 --fix","check:prettier":"prettier --check .","check:types":"tsc --noEmit",changelog:"npx conventional-changelog -p angular -i CHANGELOG.md -s --commit-path .",release:"bumpp --execute='pnpm run changelog' --all",prepare:"husky install",postbuild:"pnpm run update:components",prepublishOnly:"pnpm run build"},dependencies:{"@clack/prompts":"0.7.0","@winches/prompts":"0.0.6","async-retry":"1.3.3",chalk:"5.3.0",commander:"11.0.0","fast-glob":"3.3.2","find-up":"7.0.0","gradient-string":"2.0.2",ora:"8.0.1",pathe:"1.1.2",tar:"6.2.1"},devDependencies:{"@commitlint/cli":"17.7.1","@commitlint/config-conventional":"17.7.0","@types/gradient-string":"1.1.3","@types/node":"20.11.30","@typescript-eslint/eslint-plugin":"6.7.2","@typescript-eslint/parser":"6.7.2",bumpp:"9.4.0","clean-package":"2.2.0","commitlint-plugin-function-rules":"2.0.2","conventional-changelog-cli":"4.1.0",eslint:"8.50.0","eslint-config-prettier":"9.0.0","eslint-import-resolver-typescript":"3.6.1","eslint-plugin-import":"2.28.1","eslint-plugin-prettier":"5.0.0","eslint-plugin-sort-destructure-keys":"1.5.0","eslint-plugin-sort-keys-fix":"1.1.2","eslint-plugin-unicorn":"52.0.0","eslint-plugin-unused-imports":"3.0.0",husky:"8.0.3","lint-staged":"14.0.1",prettier:"3.3.2",tsup:"7.2.0",tsx:"4.7.1",typescript:"5.2.2"},engines:{pnpm:">=9.x",node:">=18.17.x"},packageManager:"pnpm@9.6.0"};function Bt(e){let t=/import {?\s*([\W\w]+?)\s*}? from ["'](.+)["']/g,n=e.match(t)??[],o=[];for(let i of n)o.push(r(i));return o.length?o:[];function r(i){let a=/import {?\s*([\W\w]+?)\s*}? from ["'](.+)["']/,p=i.match(a)??[];return [p[1]??"",p[2]??""]}}function V(e,t){let n=new RegExp(`\\s*${e}:\\s\\[([\\w\\W]*?)\\]\\s*`);return n.test(t)?t.match(n)?.[1]?.split(/,\s/g).map(o=>o.trim().replace(/["'`]/g,"")).filter(Boolean)??[]:[]}function me(e,t,n,o){let r=new RegExp(`\\s*${e}:\\s\\[([\\w\\W]*?)\\]\\s*`),i=o??n.map(m=>JSON.stringify(m)).join(", ");if(r.test(t)){let m=e==="content"?`
  ${e}: [${i}]`:`
  ${e}: [${n}]`;return t.replace(r,m)}let a=t.split(`
`),p=a.findIndex(m=>m.includes("content:")),g=a.findIndex(m=>m.includes("module.exports =")),l=p!==-1?p-1:g!==-1?g:0;return e==="content"?a.splice(l+1,0,`  ${e}: [${i}],`):a.splice(l+1,0,`  ${e}: [${n.map(m=>m.replace(/["'`]/g,""))}],`),a.join(`
`)}var ue="".padEnd(7),Gt="Missing";async function Ht(e){let{all:t,allDependencies:n,isNextUIAll:o,upgradeOptionList:r}=e,i=[],a=new Set,p=await mo(t,o,n,a),g=r.map(c=>({...c,latestVersion:Z(c.version,c.latestVersion)})),l=await Promise.all(r.map(c=>Se(c.package,n,a,c.peerDependencies))),m=await uo([...a]),y=[...g,...p.allOutputList],h=[...l.flat(),...p.allPeerDepList,...m].filter((c,u,d)=>u===d.findIndex(f=>f.package===c.package));return lo(y,h),i=[...y,...h].filter((c,u,d)=>!c.isLatest&&u===d.findIndex(f=>f.package===c.package)),go(i),i}function Jt(e,t=!1){if(!e.length)return "";let n=[],o={latestVersion:0,package:0,version:0};for(let r of e)for(let i in r){if(!Object.prototype.hasOwnProperty.call(r,i)||!r[i])continue;i==="version"&&(r[i]=r[i].replace(De,""));let a=i==="version"?r[i].replace(U,"").length:r[i].length;o[i]=Math.max(o[i],a);}for(let r of e){if(r.isLatest){if(t)continue;n.push(`  ${N.white(`${`${r.package}@${r.versionMode||""}${r.latestVersion}`.padEnd(o.package+ue.length+ue.length)}`)}${N.greenBright("latest").padStart(o.version)}${ue}`);continue}n.push(`  ${N.white(`${r.package.padEnd(o.package+ue.length)}${ue}${J(`${r.versionMode||""}${r.version}`,o.version)}  ->  ${r.versionMode||""}${r.latestVersion}`)}${ue}`);}return n.join(`
`)}async function Se(e,t,n,o){if(o=o||JSON.parse(await te(`npm show ${e} peerDependencies --json`))||{},!o||!Object.keys(o).length)return [];let r=[];for(let[i,a]of Object.entries(o)){if(r.some(y=>y.package===i))continue;let p=t[i];if(!p){n.add(i);continue}let{versionMode:g}=ee(t,i),l=M(a),m=E(p,l)>=0;m&&(l=M(p)),r.push({isLatest:m,latestVersion:m?l:Z(p,l),package:i,version:p,versionMode:g});}return r}function lo(e,t){let n=e.length===1?"Component":"Components",o={components:{color:"blue",text:"",title:N.blue(n)},peerDependencies:{color:"yellow",text:"",title:N.yellow("PeerDependencies")}},r=Jt(e),i=Jt(t,!0);r.length&&$e({...o.components,text:r}),s.newLine(),s.log(N.gray(`Required min version: ${t.filter(a=>!a.isLatest).map(a=>`${a.package}>=${a.latestVersion.replace(U,"")}`).join(", ")}`)),i.length&&$e({...o.peerDependencies,text:i});}async function mo(e,t,n,o){if(!e||!t)return {allOutputList:[],allPeerDepList:[]};let r=w.latestVersion,{currentVersion:i,versionMode:a}=ee(n,k),p=Z(i,r),g=E(i,r)>=0,l=await Se(k,n,o),m=await Se(G,n,o),y=[{isLatest:g,latestVersion:p,package:k,version:i,versionMode:a}],h=[...l,...m];return {allOutputList:y,allPeerDepList:h}}async function uo(e){let t=[];for(let n of e){let r={isLatest:!1,latestVersion:await q(n),package:n,version:N.red(Gt),versionMode:""};t.push(r);}return t}function go(e){let t={major:0,minor:0,patch:0};for(let o of e){if(o.version===Gt){t.major++;continue}let r=j(o.latestVersion);Le(o.version,r)?t.major++:Re(o.version,r)?t.minor++:t.patch++;}let n=Object.entries(t).reduce((o,[r,i])=>i?`${o}${N.yellowBright(i)} ${r}, `:o,"").replace(/, $/,"");return n&&(s.log(n),s.newLine()),t}function oe(e,t){let{errorInfo:n,missingDependencies:o,tailwindName:r}=t;return e==="missingDependencies"?{level:"error",name:"missingDependencies",outputFn:()=>{s.log("You have not installed the required dependencies"),s.newLine(),s.log("The required dependencies are:"),o.forEach(i=>{s.log(`- ${i}`);}),s.newLine(),s.log(`See more info here: ${N.underline(tt)}`);}}:e==="incorrectTailwind"?{level:"error",name:"incorrectTailwind",outputFn:()=>{s.log(`Your ${r} is incorrect`),s.newLine(),s.log("The missing part is:"),n.forEach(i=>{s.log(`- need to add ${i}`);}),s.newLine(),s.log(`See more info here: ${N.underline(`${Ve}-1`)}`);}}:{level:"error",name:"incorrectApp",outputFn:()=>{s.log("Your App.tsx is incorrect"),s.newLine(),s.log("The missing part is:"),n.forEach(i=>{s.log(`- need to add ${i}`);}),s.newLine(),s.log(`See more info here: ${N.underline(tt)}`);}}}async function re(e,t,n){let o=[],{allDependencies:r,packageNames:i,peerDependencies:a}=n??{},p=[];if(a){let g=await fo({allDependencies:r,packageNames:i});p.push(...g);}if(e==="all"){let g=t.has(k),l=t.has(Pe),m=t.has(ve);if(g&&l&&!p.length)return [!0];!g&&o.push(k),!l&&o.push(Pe),!m&&o.push(ve);}else if(e==="partial"){let g=t.has(Pe),l=t.has(ve),m=t.has(ce),y=t.has(G);if(g&&m&&y&&!p.length)return [!0];!g&&o.push(Pe),!m&&o.push(ce),!y&&o.push(G),!l&&o.push(ve);}return [!1,...o,...a?p:[]]}async function fo(e){let{allDependencies:t,packageNames:n}=e,o=[];for(let r of n){let i=await Se(r,t,new Set);for(let a of i)if(!a.isLatest){let p=o.findIndex(m=>m.includes(a.package)),l=j(o[p]||"")?.match(/@([\d.]+)/)?.[1];l&&E(l,j(a.latestVersion))<=0&&o.splice(p,1),o.push(`${a.package}@${a.latestVersion}`);}}return o}function ie(e,t,n,o,r,i){if(e==="partial"&&!n.length)return [!0];let a=[],p=r??readFileSync(t,"utf-8"),g=V("content",p),l=V("plugins",p);if(e==="all"){let y=V("darkMode",p).some(u=>u.includes("class")),h=g.some(u=>u.includes(I.content)),c=l.some(u=>I.checkPluginsRegex.test(u));if(y&&h&&c)return [!0];!y&&a.push(I.darkMode),!h&&a.push(I.content),!c&&a.push(I.plugins);}else if(e==="partial"){let m=qe.content(n,o),y=!1,h=g.some(u=>u.includes(I.content)?(y=!0,!0):u.includes(m));i&&y&&s.log(`
${N.yellow("Attention")} Individual components from NextUI do not require the "${N.bold(I.content)}" in the tailwind config
For optimized bundle sizes, consider using "${N.bold(m)}" instead`);let c=l.some(u=>I.checkPluginsRegex.test(u));if(h&&c)return [!0];!h&&a.push(m),!c&&a.push(I.plugins);}return [!1,...a]}function be(e,t){let n=[];if(e==="all"||e==="partial"){let o=readFileSync(t,"utf-8"),i=Bt(o).some(([a])=>a.includes(nt.import));if(i)return [!0];!i&&n.push(nt.import);}return [!1,...n]}function ge(e){let t=[],n;if(e){try{n=readFileSync(e,"utf-8");let o=n.includes(D.content);if(o)return [!0];!o&&t.push(D.content);}catch(o){t.push(`Error reading .npmrc file: ${e} 
Error: ${o}`);}return [!1,...t]}return [!1,...t]}function de(e,t=!0){let n=[];for(let o of e)if(!w.nextUIComponentsKeysSet.has(o)){let r=ke(w.nextUIComponentsKeys,o);n.push([o,r]);}if(n.length){let[o,r]=n.reduce((i,[a,p])=>[i[0]+N.underline(a)+", ",i[1]+(p?N.underline(p)+", ":"")],["",""]);return t&&s.prefix("error",`Illegal components: ${o.replace(/, $/,"")}${r?`
${"".padEnd(12)}It may be a typo, did you mean ${r.replace(/, $/,"")}?`:""}`),!1}return !0}var it=new Map;async function fe(e,t){return new Promise((n,o)=>{try{let{cache:r=!0,logCmd:i=!0}=t||{};it.has(e)&&r&&n(it.get(e)),i&&(s.newLine(),s.log(`${e}`));let a=execSync(e,{stdio:"inherit",...t?vt(t,["logCmd"]):{}});if(a){let p=a.toString();n(p),it.set(e,p);}n("");}catch(r){o(r);}})}async function st(e,t=[]){if(le("debug"))for(let n of t)s.warn(`Debug: ${n}`);else await fe(e);}var at=["npm","bun","pnpm","yarn"];var Wt={"bun.lockb":"bun","npm-shrinkwrap.json":"npm","package-lock.json":"npm","pnpm-lock.yaml":"pnpm","yarn.lock":"yarn"};async function Y(e=R){let t="npm",n=await findUp(Object.keys(Wt),{cwd:e});return n&&(t=Wt[yo.basename(n)]),t}function Xt(e,t){let{format:n=!1,write:o=!0}=t,r=readFileSync(e,"utf-8");r=`import {NextUIProvider} from "@nextui-org/react";
${r}`,r=Co(r),o&&writeFileSync(e,r,"utf-8"),n&&execSync(`npx prettier --write ${e}`,{stdio:"ignore"});}function Co(e){let t=/return\s*\(([\S\s]*?)\);/g;return e.replace(t,(o,r)=>`return (
      <NextUIProvider>
        ${r.trim()}
      </NextUIProvider>
    );`)}function Be(e,t){let{errorInfoList:n,format:o=!1,tailwindPath:r,write:i=!0}=t;if(!n.length)return;let a=readFileSync(r,"utf-8"),p=V("content",a),g=V("plugins",a);for(let l of n){let[m,y]=ko(l);if(m==="content"){if(p.includes(I.content))continue;p=p.filter(c=>!c.includes("@nextui-org/theme/dist/")),p.push(y),a=me("content",a,p,p.map((c,u,d)=>u===0?d.length===1?`
    ${JSON.stringify(c)}
`:`
    ${JSON.stringify(c)}`:d.length-1===u?`    ${JSON.stringify(c)}
  `:`    ${JSON.stringify(c)}`).join(`,
`));}else m==="plugins"&&(g.push(y),a=me("plugins",a,g),a=`${I.importContent(r.endsWith(".ts"))}
${a}`);if(e==="all"&&m==="darkMode"){let h=a.indexOf("plugins")-1,c=I.darkMode;a=`${a.slice(0,h)} ${c},
${a.slice(h)}`;}}if(i&&writeFileSync(r,a,"utf-8"),o)try{execSync(`npx prettier --write ${r}`,{stdio:"ignore"});}catch{s.warn(`Prettier failed to format ${r}`);}}function ko(e){return I.darkMode.includes(e)?["darkMode",e]:I.plugins.includes(e)?["plugins",e]:["content",e]}function he(e,t=!0,n=!0,o=void 0){if(!existsSync(e))t&&writeFileSync(e,D.content,"utf-8");else {let r=readFileSync(e,"utf-8");r=`${D.content}
${r}`,t&&writeFileSync(e,r,"utf-8");}if(!o){s.newLine(),s.log(`Added the required content in file: ${e}`),n&&!le("debug")&&(s.newLine(),s.log("Pnpm restructure will be run now"),execSync("pnpm install",{stdio:"inherit"}));return}o({message:`Added the required content in file: ${e}`,runInstall:n});}var Qt="https://codeload.github.com/nextui-org/next-app-template/tar.gz/main",Zt="https://codeload.github.com/nextui-org/next-pages-template/tar.gz/main",en="https://codeload.github.com/nextui-org/vite-template/tar.gz/main",tn="next-app-template-main",nn="next-pages-template-main",on="vite-template-main",rn="next-app-template",sn="next-pages-template",an="vite-template";function pn(e,t){return e==="all"?`// tailwind.config.js
const {nextui} = require("@nextui-org/react");

/** @type {import('tailwindcss').Config} */
module.exports = {
  content: [
    "./node_modules/@nextui-org/theme/dist/**/*.{js,ts,jsx,tsx}",
  ],
  theme: {
    extend: {},
  },
  darkMode: "class",
  plugins: [nextui()],
};`:`// tailwind.config.js
const {nextui} = require("@nextui-org/theme");

/** @type {import('tailwindcss').Config} */
module.exports = {
  content: [
    ${JSON.stringify(t)},
  ],
  theme: {
    extend: {},
  },
  darkMode: "class",
  plugins: [nextui()],
};`}var mt={onCancel:()=>{s.log(`${N.red("\u2716")} Operation cancelled`),process.exit(0);}};async function xe(e,t){return (await lt({hint:"- Space to select. Return to submit",message:e,min:1,name:"value",type:"autocompleteMultiselect",...t?{choices:t}:{}},mt)).value}async function Te(e,t){return (await lt({message:e,name:"value",type:"select",...t?{choices:t}:{}},mt)).value}async function cn(e,t){return (await lt({hint:"- Space to select. Return to submit",message:e,min:1,name:"value",type:"multiselect",...t?{choices:t}:{}},mt)).value}async function un(e,t){let{addApp:n=!1,all:o=!1,appPath:r=B("**/App.(j|t)sx")[0],packagePath:i=P("package.json"),tailwindPath:a=B("**/tailwind.config.(j|t)s")[0]}=t;var{allDependencies:p,allDependenciesKeys:u,currentComponents:d}=S(i);let g=t.prettier??u.has("prettier"),l=!!p[k];if(!e.length&&!o?e=await xe("Which components would you like to add?",w.nextUIComponents.filter(x=>!d.some(A=>A.name===x.name)).map(x=>({description:x.description,title:x.name,value:x.name}))):o&&(e=[k]),!o&&!de(e))return;var{allDependenciesKeys:u,currentComponents:d}=S(i);let m=d.map(x=>x.name),y=e.filter(x=>m.includes(x)||l&&x===k);if(y.length&&!le("debug")){s.prefix("error",`\u274C You have already added the following components: ${y.map(x=>N.underline(x)).join(", ")}`);return}if(n&&!r){s.prefix("error","\u274C App.(j|t)sx file not found. Please specify the appPath if the default search path does not locate your file.  'add --appPath=yourAppPath'");return}let h=await Y(),c=h==="npm"?"install":"add";if(o){let[,...x]=await re("all",u);x.length&&(s.info(`Adding required dependencies: ${[...x].map(A=>N.underline(A)).join(", ")}`),await st(`${h} ${c} ${[...x].join(" ")}`,x));}else {let[,...x]=await re("partial",u),A=[...x,...e.map(v=>w.nextUIComponentsMap[v].package)];s.info(`Adding required dependencies: ${[...A].map(v=>N.underline(v)).join(", ")}`),await st(`${h} ${c} ${[...A].join(" ")}`,A);}var{allDependenciesKeys:u,currentComponents:d}=S(i);let f=o?"all":"partial",C=h==="pnpm";if(a){let[,...x]=ie(f,a,d,C,void 0,!0);Be(f,{errorInfoList:x,format:g,tailwindPath:a}),s.newLine(),s.log(`Tailwind CSS settings have been updated in: ${a}`);}else {let x=qe.content(d,C),A=pn(f,x),v=P("tailwind.config.js");writeFileSync(v,A,"utf-8"),s.newLine(),s.info(`Tailwind CSS configuration file created at: ${v}`);}if(n&&r&&existsSync(r)){let[x]=be(f,r);x||(Xt(r,{format:g}),s.newLine(),s.info(`NextUIProvider successfully added to the App file at: ${r}`),s.warn("Please check the placement of NextUIProvider in the App file to ensure it's correctly integrated.'"));}if(h==="pnpm"){let x=P(".npmrc");if(!existsSync(x))writeFileSync(P(".npmrc"),D.content,"utf-8");else {let[A]=ge(x);A||he(x);}}s.newLine(),s.success("\u2705 Components added successfully"),(u.has(k)||o)&&d.length&&(s.newLine(),s.log(`${N.yellow("Attention")} Individual components from NextUI do not require the \`@nextui-org/react\` package. For optimized bundle sizes, consider using individual components.`),s.log("The redundant dependencies are:"),[...new Set(d)].forEach(x=>{s.log(`- ${x.package}`);})),s.newLine(),s.grey(`Please check the ${N.bold("NextUIProvider")} whether in the correct place (ignore if added)
See more info here: ${Fe}`),process.exit(0);}async function dn(e){let{appPath:t=B("**/App.(j|t)sx")[0],checkApp:n=!1,checkPnpm:o=!0,checkTailwind:r=!0,packagePath:i=P("package.json"),tailwindPath:a=B("**/tailwind.config.(j|t)s")}=e,p=Me(n),g=Me(o),l=Me(r),m=[a].flat(),{allDependencies:y,allDependenciesKeys:h,currentComponents:c,isAllComponents:u}=S(i);if(!c.length&&!u){s.prefix("error",`\u274C No ${N.underline("NextUI components")} found in your project. Please consult the installation guide at: https://nextui.org/docs/guide/installation#global-installation`);return}let d=[];if(u&&c.length&&d.push({level:"warn",name:"redundantDependencies",outputFn:()=>{s.log("You have installed some unnecessary dependencies. Consider removing them for optimal performance."),s.newLine(),s.log("The following dependencies are redundant:"),c.forEach(f=>{s.log(`- ${f.package}`);});}}),l&&!m.length&&d.push({level:"error",name:"missingTailwind",outputFn:()=>{s.log("Missing tailwind.config.(j|t)s file. To set up, visit: "+N.underline(Ve));}}),p&&!t&&d.push({level:"error",name:"missingApp",outputFn:()=>{s.log("App.(j|t)sx file not found. Please specify the path using: doctor --appPath=[yourAppPath]");}}),u){let[f,...C]=await re("all",h,{allDependencies:y,packageNames:[k],peerDependencies:!0});if(c.length){let[x,...A]=await re("partial",h,{allDependencies:y,packageNames:c.map(v=>v.package),peerDependencies:!0});f=x||f,C=[...A,...C].filter((v,X,we)=>(v=j(v).replace(/@[\d.]+/g,""),we.findIndex(K=>j(K).replace(/@[\d.]+/g,"")===v)===X));}if(f||d.push(oe("missingDependencies",{missingDependencies:C})),l)for(let x of m){let[A,...v]=ie("all",x);if(!A){let X=basename(x);d.push(oe("incorrectTailwind",{errorInfo:v,tailwindName:X}));}}if(p&&t){let[x,...A]=be("all",t);x||d.push(oe("incorrectApp",{errorInfo:A}));}}else if(c.length){let[f,...C]=await re("partial",h,{allDependencies:y,packageNames:c.map(x=>x.package),peerDependencies:!0});if(f||d.push(oe("missingDependencies",{missingDependencies:C})),l){let x=await Y()==="pnpm";for(let A of m){let[v,...X]=ie("partial",A,c,x,void 0,!0);if(!v){let we=basename(A);d.push(oe("incorrectTailwind",{errorInfo:X,tailwindName:we}));}}}if(p&&t){let[x,...A]=be("partial",t);x||d.push(oe("incorrectApp",{errorInfo:A}));}}if(g&&await Y()==="pnpm"){let C=P(".npmrc"),[x,...A]=ge(C);x||d.push({level:"error",name:"incorrectPnpm",outputFn:()=>{s.log(`The pnpm setup is incorrect 
Please update your configuration according to the guidelines provided at: `+N.underline(jt)),s.newLine(),s.log("Required changes:"),A.forEach(v=>{s.log(`- Add ${v}`);});}});}if(!d.length){s.newLine(),s.success("\u2705 Your project has no detected issues.");return}s.prefix("error",`\u274C Your project has ${N.underline(d.length)} issue${d.length===1?"":"s"} that require attention`),s.newLine();for(let f=0;f<d.length;f++){let C=d[f];s[C.level](`\u2757\uFE0FIssue ${f+1}: ${N.bold(C.name)}`),s.newLine(),C.outputFn(),s.newLine();}process.exit(0);}async function fn(e){let{packagePath:t=P("package.json")}=e,{currentComponents:n}=S(t);ne({components:n}),zt(),process.exit(0);}async function So(e){let t=await fetch(e);if(!t.body)throw new Error(`Failed to download: ${e}`);return Readable.fromWeb(t.body)}async function hn(e,t){await Qn(async n=>{try{await pipeline(await So(t),$o.x({cwd:e}));}catch(o){n(new Error(`Failed to download ${t} Error: ${o}`));}},{retries:3});}function xn(e,t){e&&(Object.keys(Ee).includes(e)||He(Object.keys(Ee),e)),t&&(at.includes(t)||He(at,t));}var Cn=e=>{isCancel(e)&&(cancel(`${N.red("\u2716")} Operation cancelled`),process.exit(0));},kn=async e=>{let t=await text(e);return Cn(t),t},ut=async e=>{let t=await select(e);return Cn(t),t},yn=spinner(),An=async e=>{let{failText:t,successText:n,task:o,text:r}=e,i=null;try{yn.start(r),i=await o,yn.stop(n);}catch{cancel(t??i??"Task failed");}return i};var Ee={app:rn,pages:sn,vite:an};async function vn(e,t){let{package:n="npm",template:o}=t;xn(o,n),_.intro(N.cyanBright("Create a new project"));let{packageName:r,projectName:i,template:a}=await Ro(n,e,o),{run:p}=se(r);if(existsSync(Xe(`${R}/${i}`))&&(_.cancel(`The project name ${N.redBright(i)} already exists`),process.exit(1)),a==="app"?(await gt(Qt),dt(tn,i)):a==="pages"?(await gt(Zt),dt(nn,i)):a==="vite"&&(await gt(en),dt(on,i)),r==="pnpm"){let g=Xe(`${R}/${i}/.npmrc`);he(g,!0,!1,({message:l})=>{_.log.message(l);});}_.note(`cd ${N.cyanBright(i)}
${N.cyanBright(r)} install`,"Next steps"),_.outro(`\u{1F680} Get started with ${N.cyanBright(`${r} ${p} dev`)}`),process.exit(0);}async function gt(e){await An({failText:"Template creation failed",successText:"Template created successfully!",task:hn(R,e),text:"Creating template..."});}function dt(e,t){try{renameSync(join(R,e),join(R,t));}catch(n){n&&_.cancel(`rename Error: ${n}`);}}async function Ro(e,t,n){let o=[{hint:"A Next.js 14 with app directory template pre-configured with NextUI (v2) and Tailwind CSS.",label:N.gray("App"),value:"app"},{hint:"A Next.js 14 with pages directory template pre-configured with NextUI (v2) and Tailwind CSS.",label:N.gray("Pages"),value:"pages"},{hint:"A Vite template pre-configured with NextUI (v2) and Tailwind CSS.",label:N.gray("Vite"),value:"vite"}];return n=await ut({initialValue:n,message:"Select a template (Enter to select)",options:o}),t=await kn({initialValue:t??Ee[n],message:"New project name (Enter to skip with default name)",placeholder:t??Ee[n]}),e=await ut({initialValue:e,message:"Select a package manager (Enter to select)",options:[{label:N.gray("npm"),value:"npm"},{label:N.gray("yarn"),value:"yarn"},{label:N.gray("pnpm"),value:"pnpm"},{label:N.gray("bun"),value:"bun"}]}),{packageName:e,projectName:t,template:n}}async function In(e){let{packagePath:t=P("package.json"),remote:n=!1}=e,o=w.nextUIComponents;try{if(!n){let{currentComponents:r}=await S(t);o=r;}if(!o.length){s.warn(`No NextUI components detected in the specified package.json at: ${t}`);return}n?ne({commandName:"list",components:o}):ne({components:o});}catch(r){s.prefix("error",`An error occurred while attempting to list the components: ${r}`);}process.exit(0);}async function $n(e,t){let{remove:n}=se(t);await fe(`${t} ${n} ${e.join(" ")}`);}async function Sn(e,t){let{currentComponents:n,isNextUIAll:o,isPnpm:r,prettier:i,tailwindPath:a}=t;if(a&&!existsSync(a)){s.prefix("warn","No tailwind.config.(j|t)s found remove action skipped");return}let p=readFileSync(a,"utf-8"),g=V("content",p),l=V("plugins",p),m=g.some(h=>h.includes(I.content));if(!n.length&&!o){let h=l.findIndex(c=>c.includes("nextui"));h!==-1&&l.splice(h,1),p=me("plugins",p,l),p=p.replace(/(const|var|let|import)[\W\w]+?nextui.*?;\n/,"");}if(!m){for(;g.some(h=>h.includes("nextui"));)g.splice(g.findIndex(h=>h.includes("nextui")),1);p=me("content",p,g);}writeFileSync(a,p,"utf-8");let[,...y]=ie(e,a,n,r,void 0,!0);Be(e,{errorInfoList:y,format:i,tailwindPath:a}),s.newLine(),s.info(`Remove the removed components tailwind content in file: ${a}`);}async function Tn(e,t){let{all:n=!1,packagePath:o=P("package.json"),tailwindPath:r=B("**/tailwind.config.(j|t)s")[0]}=t;var{allDependencies:c,allDependenciesKeys:i,currentComponents:u}=S(o);let a=await Y(),p=t.prettier??i.has("prettier"),g=!!c[k];if(!u.length&&!g){s.prefix("error",`No NextUI components detected in your package.json at: ${o}`);return}if(n||g)e=g?[k]:u.map(f=>f.package);else if(!e.length)e=await xe("Select the components to remove",u.map(f=>({title:f.package,value:f.package})));else {if(!de(e))return;e=Mt(e);}let l=e.includes(k)?await Ot(e,c):u.filter(f=>e.some(C=>C.includes(f.package)||C.includes(f.name)));ne({components:l,message:N.yellowBright("\u2757\uFE0F Components slated for removal:")}),await Te("Confirm removal of these components:",[{title:"Yes",value:!0},{title:"No",value:!1}])||process.exit(0);let y=[...e];u.filter(f=>!e.includes(f.package)).length||(c[G]&&y.push(G),c[ce]&&y.push(ce)),await $n(y,a);var{allDependencies:c,currentComponents:u}=S(o,!1);if(g=!!c[k],Sn(g?"all":"partial",{currentComponents:u,isNextUIAll:g,isPnpm:a==="pnpm",prettier:p,tailwindPath:r}),!u.length&&!g){if(a==="pnpm"){let f=P(".npmrc");if(existsSync(f)){let C=readFileSync(f,"utf-8");C=C.replace(D.content,""),s.newLine(),s.info("Removing specified .npmrc file content"),writeFileSync(f,C,"utf-8");}}s.newLine(),s.warn(`No NextUI components remain installed. Ensure the NextUIProvider is also removed if necessary.
For more information, visit: ${Fe}`);}s.newLine(),s.success(`\u2705 Successfully removed the specified NextUI components: ${e.map(f=>N.underline(f)).join(", ")}`),process.exit(0);}async function Nn(e){if(e==="pnpm"){let t=P(".npmrc");if(!existsSync(t))writeFileSync(P(".npmrc"),D.content,"utf-8");else {let[n]=ge(t);n||he(t);}}}async function En(e,t){let{all:n=!1,packagePath:o=P("package.json"),write:r=!1}=t,{allDependencies:i,currentComponents:a}=S(o,!1),p=!!i[k],g=[];for(let c of a){let u=w.nextUIComponentsMap[c.name]?.version||await q(c.package);g.push({...c,isLatest:E(c.version,u)>=0,latestVersion:u});}if(!g.length&&!p){s.prefix("error",`No NextUI components detected in your package.json at: ${o}`);return}if(n)e=a.map(c=>c.package);else if(e.length){if(!de(e))return}else {if(p){let c={isLatest:E(w.latestVersion,M(i[k]))<=0,latestVersion:w.latestVersion,package:k,version:M(i[k])};g.push(c);}g.every(c=>c.isLatest)&&(s.success("\u2705 All NextUI packages are up to date"),process.exit(0)),e=await xe("Select the components to upgrade",g.map(c=>{let u=E(c.version,c.latestVersion)>=0;return {disabled:u,disabledMessage:"Already up to date",title:`${c.package}${u?"":`@${c.version} -> ${Z(c.version,c.latestVersion)}`}`,value:c.package}}));}e=e.map(c=>w.nextUIComponentsMap[c]?.package?w.nextUIComponentsMap[c].package:c);let l=g.filter(c=>e.includes(c.package)),m=await Ht({all:n,allDependencies:i,isNextUIAll:p,upgradeOptionList:l}),y=[],h=await Y();if(m.length){let c=await Te("Would you like to proceed with the upgrade?",[{title:"Yes",value:!0},{description:"Select this if you wish to exclude certain packages from the upgrade",title:"No",value:!1}]),{install:u}=se(h);if(c||await Te("Would you like to exclude any packages from the upgrade?",[{description:"Select this to choose packages to exclude",title:"Yes",value:!0},{description:"Select this to proceed without excluding any packages",title:"No",value:!1}])&&(y=await cn("Select the packages you want to exclude from the upgrade:",m.map(f=>({description:`${f.version} -> ${Z(f.version,f.latestVersion)}`,title:f.package,value:f.package})))),m=m.filter(d=>!y.some(f=>d.package===f)),r){let d=JSON.parse(Un.readFileSync(o,"utf8"));m.forEach(f=>{d.dependencies[f.package]=f.latestVersion.replace(U,"");}),Un.writeFileSync(o,JSON.stringify(d,null,2)),s.newLine(),s.success("\u2705 Upgrade versions written to package.json"),process.exit(0);}else await fe(`${h} ${u} ${m.reduce((d,f,C)=>`${d}${C===0?"":" "}${f.package}@${f.latestVersion.replace(U,"")}`,"")}`);}Nn(h),s.newLine(),s.success("\u2705 Upgrade complete. All components are up to date."),process.exit(0);}var ft=["add","env","init","list","upgrade","doctor","remove"],F=new Command;F.name("nextui").usage("[command]").description(At(`
NextUI CLI v${Ke.version}
`,"")).version(Ke.version,"-v, --version","Output the current version").helpOption("-h, --help","Display help for command").allowUnknownOption().option("--no-cache","Disable cache, by default data will be cached for 30m after the first request").option("-d, --debug","Debug mode will not install dependencies").action(async(e,t)=>{let n=!1;if(t){let o=t.args?.[0];if(o&&!ft.includes(o)){n=!0;let r=ke(ft,o);r?s.error(`Unknown command '${o}', Did you mean '${N.underline(r)}'?`):s.error(`Unknown command '${o}'`);}}if(!n){let r=(await te("nextui --help")).split(`
`);r=r.filter(i=>i&&!i.includes("NextUI CLI v")),r=r.map(i=>{let a=i.match(/(\w+)\s\[/)?.[1];return a?i.replace(a,N.cyan(a)):i}),s.log(r.join(`
`));}process.exit(0);});F.command("init").description("Initializes a new project").argument("[projectName]","Name of the project to initialize").option("-t --template [string]","Specify a template for the new project, e.g., app, pages").option("-p --package [string]","The package manager to use for the new project","npm").action(vn);F.command("add").description("Adds components to your project").argument("[components...]","Names of components to add").option("-a --all [boolean]","Add all components",!1).option("-p --packagePath [string]","Specify the path to the package.json file").option("-tw --tailwindPath [string]","Specify the path to the tailwind.config.js file").option("-app --appPath [string]","Specify the path to the App.tsx file").option("--prettier [boolean]","Apply Prettier formatting to the added content").option("--addApp [boolean]","Include App.tsx file content that requires a provider",!1).action(un);F.command("upgrade").description("Upgrades project components to the latest versions").argument("[components...]","Names of components to upgrade").option("-p --packagePath [string]","Specify the path to the package.json file").option("-a --all [boolean]","Upgrade all components",!1).option("-w --write [boolean]","Write the upgrade version to package.json file",!1).action(En);F.command("remove").description("Removes components from the project").argument("[components...]","Names of components to remove").option("-p --packagePath [string]","Specify the path to the package.json file").option("-a --all [boolean]","Remove all components",!1).option("-tw --tailwindPath [string]","Specify the path to the tailwind.config.js file").option("--prettier [boolean]","Apply Prettier formatting to the added content").action(Tn);F.command("list").description("Lists all components, showing status, descriptions, and versions").option("-p --packagePath [string]","Specify the path to the package.json file").option("-r --remote","List all components available remotely").action(In);F.command("env").description("Displays debugging information for the local environment").option("-p --packagePath [string]","Specify the path to the package.json file").action(fn);F.command("doctor").description("Checks for issues in the project").option("-p --packagePath [string]","Specify the path to the package.json file").option("-tw --tailwindPath [string]","Specify the path to the tailwind.config.js file").option("-app --appPath [string]","Specify the path to the App.tsx file").option("-ca --checkApp [boolean]","Check the App.tsx file",!1).option("-ct --checkTailwind [boolean]","Check the tailwind.config.js file",!0).option("-cp --checkPnpm [boolean]","Check for Pnpm",!0).action(dn);F.hook("preAction",async e=>{let t=e.args?.[0],n=e.rawArgs.slice(2),o=n.includes("--no-cache"),r=n.includes("--debug")||n.includes("-d");if(Ze(o),w.debug=r,t&&ft.includes(t)){let g=(await Rt()).components;Ft(g);}let i=await pe("cliLatestVersion"),a=await pe("latestVersion");w.latestVersion=a,w.cliLatestVersion=i;let p=Ke.version;E(p,i)===-1&&($e({center:!0,color:"yellow",padding:1,text:`${N.gray(`Available upgrade: v${p} -> ${N.greenBright(`v${i}`)}
Run \`${N.cyan("npm install -g nextui-cli@latest")}\` to upgrade
Changelog: ${N.underline("https://github.com/nextui-org/nextui-cli/releases")}`)}`,title:Ge("NextUI CLI")}),s.newLine());});F.parseAsync(process.argv).catch(async e=>{s.newLine(),s.error("Unexpected error. Please report it as a bug:"),s.log(e),s.newLine(),process.exit(1);});
//# sourceMappingURL=out.js.map
//# sourceMappingURL=index.js.map